var t,e,l=Object.defineProperty,a=Object.defineProperties,i=Object.getOwnPropertyDescriptors,s=Object.getOwnPropertySymbols,u=Object.prototype.hasOwnProperty,h=Object.prototype.propertyIsEnumerable,n=(t,e,a)=>e in t?l(t,e,{enumerable:!0,configurable:!0,writable:!0,value:a}):t[e]=a,r=(t,e)=>{for(var l in e||(e={}))u.call(e,l)&&n(t,l,e[l]);if(s)for(var l of s(e))h.call(e,l)&&n(t,l,e[l]);return t},d=(t,e,l)=>new Promise(((a,i)=>{var s=t=>{try{h(l.next(t))}catch(e){i(e)}},u=t=>{try{h(l.throw(t))}catch(e){i(e)}},h=t=>t.done?a(t.value):Promise.resolve(t.value).then(s,u);h((l=l.apply(t,e)).next())}));import{_ as o,af as f,ag as c,b as p,c as m,w as g,e as v,n as _,M as w,E as y,q as $,F as x,i as S,d as b,r as C,l as N,m as L,o as V,aR as M,u as O,J as k,s as U,aS as j,C as P,D as G,k as D,f as I,t as A,H as R,j as E}from"./index-6e705c16.js";const F=o({name:"uv-waterfall",mixins:[f,c,{props:r({modelValue:{type:Array,default:()=>[]},idKey:{type:String,default:"id"},addTime:{type:Number,default:200},columnCount:{type:[Number,String],default:2},columnGap:{type:[Number,String],default:20},leftGap:{type:[Number,String],default:0},rightGap:{type:[Number,String],default:0},showScrollbar:{type:[Boolean],default:!1},columnWidth:{type:[Number,String],default:"auto"},width:{type:[Number,String],default:""},height:{type:[Number,String],default:""}},null==(e=null==(t=uni.$uv)?void 0:t.props)?void 0:e.waterfall)}],data:()=>({list1:[],list2:[],list3:[],list4:[],list5:[],tempList:[]}),computed:{copyValue(){return this.$uv.deepClone(this.modelValue)},columnNum(){return this.columnCount<=0?0:this.columnCount>=5?5:this.columnCount},gapLeftStyle(){const t={};return t.width=this.$uv.addUnit(this.leftGap),t},gapRightStyle(){const t={};return t.width=this.$uv.addUnit(this.rightGap),t},gapCenterStyle(){const t={};return t.width=this.$uv.addUnit(this.columnGap),t},nvueWaterfallStyle(){const t={};return 0!=this.width&&(t.width=this.$uv.addUnit(this.width)),0!=this.height&&(t.height=this.$uv.addUnit(this.height)),t.width||(t.width=this.$uv.addUnit(this.$uv.sys().windowWidth,"px")),t.height||(t.height=this.$uv.addUnit(this.$uv.sys().windowHeight,"px")),this.$uv.deepMerge(t,this.$uv.addStyle(this.customStyle))}},watch:{copyValue(t,e){if(0!=t.length){let l=Array.isArray(e)&&e.length>0?e.length:0;this.tempList=this.tempList.concat(this.$uv.deepClone(t.slice(l))),this.splitData()}}},mounted(){this.tempList=this.$uv.deepClone(this.copyValue),this.splitData()},methods:{scrolltolower(t){this.$uv.sleep(30).then((()=>{this.$emit("scrolltolower")}))},splitData(){return d(this,null,(function*(){let t=[],e={};if(!this.tempList.length)return;for(let h=1;h<=this.columnNum;h++){const e=yield this.$uvGetRect(`#uv-waterfall-${h}`);t.push((l=r({},e),a(l,i({name:h}))))}var l;let s=this.tempList[0];if(!s)return;const u=this.getMin(t);if(s.width=u.width,this[`list${u.name}`].push(s),e.name=`list${u.name}`,e.value=s,this.$emit("changeList",e),this.tempList.splice(0,1),this.tempList.length){let t=this.addTime;yield this.$uv.sleep(t),this.splitData()}else this.$emit("finish")}))},getMin(t){let e=null;if(t.filter((t=>0==t.height)).length){let a=[];t.map(((t,e)=>{a.push({len:this[`list${e+1}`].length,item:t})}));const i=Math.min.apply(Math,a.map((t=>t.len)));try{const{item:t}=a.find((t=>t.len==i&&0==t.item.height));e=t}catch(l){const{item:t}=a.find((t=>0==t.item.height));e=t}}else{const l=Math.min.apply(Math,t.map((t=>t.height))),[a]=t.filter((t=>t.height==l));e=a}return e},clear(){return d(this,null,(function*(){for(let t=0;t<this.columnCount;t++)this[`list${t+1}`]=[];this.$emit("update:modelValue",[]),this.tempList=[],yield this.$uv.sleep(300),this.$emit("clear")}))},remove(t){let e=-1;for(let l=1;l<=this.columnCount;l++)e=this[`list${l}`].findIndex((e=>e[this.idKey]==t)),-1!=e&&this[`list${l}`].splice(e,1);e=this.modelValue.findIndex((e=>e[this.idKey]==t)),-1!=e&&this.$emit("update:modelValue",this.modelValue.splice(e,1)),this.$emit("remove",t)}}},[["render",function(t,e,l,a,i,s){const u=S;return p(),m(u,{class:"uv-waterfall"},{default:g((()=>[v(u,{class:"uv-waterfall__gap_left",style:_([s.gapLeftStyle])},null,8,["style"]),s.columnNum>=1?(p(),m(u,{key:0,id:"uv-waterfall-1",class:"uv-waterfall__column"},{default:g((()=>[w(t.$slots,"list1",{},void 0,!0)])),_:3})):y("",!0),s.columnNum>=2?(p(),$(x,{key:1},[v(u,{class:"uv-waterfall__gap_center",style:_([s.gapCenterStyle])},null,8,["style"]),v(u,{id:"uv-waterfall-2",class:"uv-waterfall__column"},{default:g((()=>[w(t.$slots,"list2",{},void 0,!0)])),_:3})],64)):y("",!0),s.columnNum>=3?(p(),$(x,{key:2},[v(u,{class:"uv-waterfall__gap_center",style:_([s.gapCenterStyle])},null,8,["style"]),v(u,{id:"uv-waterfall-3",class:"uv-waterfall__column"},{default:g((()=>[w(t.$slots,"list3",{},void 0,!0)])),_:3})],64)):y("",!0),s.columnNum>=4?(p(),$(x,{key:3},[v(u,{class:"uv-waterfall__gap_center",style:_([s.gapCenterStyle])},null,8,["style"]),v(u,{id:"uv-waterfall-4",class:"uv-waterfall__column"},{default:g((()=>[w(t.$slots,"list4",{},void 0,!0)])),_:3})],64)):y("",!0),s.columnNum>=5?(p(),$(x,{key:4},[v(u,{class:"uv-waterfall__gap_center",style:_([s.gapCenterStyle])},null,8,["style"]),v(u,{id:"uv-waterfall-5",class:"uv-waterfall__column"},{default:g((()=>[w(t.$slots,"list5",{},void 0,!0)])),_:3})],64)):y("",!0),v(u,{class:"uv-waterfall__gap_right",style:_([s.gapRightStyle])},null,8,["style"])])),_:3})}],["__scopeId","data-v-45819e5b"]]),H=o(b({__name:"waterfall",setup(t){const e=C([]),l=N({list1:[],list2:[]}),a=C(10),i=C(10),s=C(10),u=L((()=>t=>{const e=(j(750)-a.value-i.value-s.value)/2;return{width:`${e}px`,height:`${e/t.w*t.h}px`}}));V((()=>d(this,null,(function*(){const{data:t}=yield r();e.value=t}))));const h=C();M((()=>{h.value.clear()}));const n=t=>{l[t.name].push(t.value)},r=()=>new Promise((t=>{const l=[{url:"https://via.placeholder.com/100x110.png/3c9cff/fff",width:100,height:110},{url:"https://via.placeholder.com/200x220.png/f9ae3d/fff",width:200,height:220},{url:"https://via.placeholder.com/300x340.png/5ac725/fff",width:300,height:340},{url:"https://via.placeholder.com/400x400.png/f56c6c/fff",width:400,height:400},{url:"https://via.placeholder.com/500x510.png/909399/fff",width:500,height:510},{url:"https://via.placeholder.com/600x606.png/3c9cff/fff",width:600,height:606},{url:"https://via.placeholder.com/310x422.png/f1a532/fff",width:310,height:422},{url:"https://via.placeholder.com/320x430.png/3c9cff/fff",width:320,height:430},{url:"https://via.placeholder.com/330x424.png/f9ae3d/fff",width:330,height:424},{url:"https://via.placeholder.com/340x435.png/5ac725/fff",width:340,height:435},{url:"https://via.placeholder.com/350x440.png/f56c6c/fff",width:350,height:440},{url:"https://via.placeholder.com/380x470.png/909399/fff",width:380,height:470}],a=[],i=t=>{const a=Math.floor(10*Math.random());return{id:uni.$uv.guid(),allowEdit:0===t,image:l[a].url,w:l[a].width,h:l[a].height,title:t%2==0?`(${e.value.length+t+1})体验uv-ui框架`:`(${e.value.length+t+1})uv-ui支持多平台`,desc:t%2==0?`(${e.value.length+t+1})欢迎使用uv-ui，uni-app生态专用的UI框架`:`(${e.value.length+t})开发者编写一套代码， 可发布到iOS、Android、H5、以及各种小程序`}};setTimeout((()=>{for(let t=0;t<20;t++)a.push(i(t));t({data:a})}),200)}));return(t,r)=>{const d=R,o=S,f=E,c=P(G("uv-waterfall"),F),w=D("layout-default-uni");return p(),m(w,null,{default:g((()=>[v(o,{class:"waterfall"},{default:g((()=>[v(c,{ref_key:"waterfall",ref:h,modelValue:O(e),"onUpdate:modelValue":r[0]||(r[0]=t=>k(e)?e.value=t:null),"add-time":10,"left-gap":O(a),"right-gap":O(i),"column-gap":O(s),onChangeList:n},{list1:g((()=>[v(o,null,{default:g((()=>[(p(!0),$(x,null,U(O(l).list1,(t=>(p(),m(o,{key:t.id,class:"waterfall-item"},{default:g((()=>[v(o,{class:"waterfall-item__image",style:_([O(u)(t)])},{default:g((()=>[v(d,{src:t.image,mode:"widthFix",style:_({width:t.width+"px"})},null,8,["src","style"])])),_:2},1032,["style"]),v(o,{class:"waterfall-item__ft"},{default:g((()=>[v(o,{class:"waterfall-item__ft__title"},{default:g((()=>[v(f,{class:"value"},{default:g((()=>[I(A(t.title),1)])),_:2},1024)])),_:2},1024),v(o,{class:"waterfall-item__ft__desc uv-line-2"},{default:g((()=>[v(f,{class:"value"},{default:g((()=>[I(A(t.desc),1)])),_:2},1024)])),_:2},1024)])),_:2},1024)])),_:2},1024)))),128))])),_:1})])),list2:g((()=>[v(o,null,{default:g((()=>[(p(!0),$(x,null,U(O(l).list2,(t=>(p(),m(o,{key:t.id,class:"waterfall-item"},{default:g((()=>[v(o,{class:"waterfall-item__image",style:_([O(u)(t)])},{default:g((()=>[v(d,{src:t.image,mode:"widthFix",style:_({width:t.width+"px"})},null,8,["src","style"])])),_:2},1032,["style"]),v(o,{class:"waterfall-item__ft"},{default:g((()=>[v(o,{class:"waterfall-item__ft__title"},{default:g((()=>[v(f,{class:"value"},{default:g((()=>[I(A(t.title),1)])),_:2},1024)])),_:2},1024),v(o,{class:"waterfall-item__ft__desc uv-line-2"},{default:g((()=>[v(f,{class:"value"},{default:g((()=>[I(A(t.desc),1)])),_:2},1024)])),_:2},1024)])),_:2},1024)])),_:2},1024)))),128))])),_:1})])),_:1},8,["modelValue","left-gap","right-gap","column-gap"])])),_:1})])),_:1})}}}),[["__scopeId","data-v-72b17e34"]]);export{H as default};
